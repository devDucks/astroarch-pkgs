# Maintainer: Mattia Procopio (astro.matto)  <matto.astro at gmail dot com>
pkgname=rpicam-apps
pkgver=1.9.1
pkgrel=2
pkgdesc="This is a small suite of libcamera-based applications to drive the cameras on a Raspberry Pi platform."
arch=(aarch64)
url="https://github.com/raspberrypi/rpicam-apps"
license=('LGPLv2' 'MIT' 'GPLv3' 'BSD2' 'BSD3')
depends=(boost libpisp python-piexif python-prctl)
makedepends=('meson' 'python-sphinx' 'python-jinja' 'libpisp')
source=("https://github.com/raspberrypi/rpicam-apps/archive/refs/tags/v$pkgver.tar.gz")
sha256sums=('04ddfa37c707b751248481aaf992da7e3f4a319930a46a3d5b37d9b858d7806a')

# paru python-pidng-git kmsxx-git
build() {
    cd $srcdir/rpicam-apps-$pkgver
    meson setup build -Dprefix=/usr -Dwerror=false
}

package() {
    mkdir -p $pkgdir/usr/lib/udev/rules.d/
    cd $srcdir/rpicam-apps-$pkgver
    DESTDIR="$pkgdir" ninja -C build install
    install -m 755 $srcdir/../99-raspberrypi-dmaheap.rules $pkgdir/usr/lib/udev/rules.d/
}
