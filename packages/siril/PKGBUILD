pkgname=siril
pkgver='1.4.0'
pkgrel=2
rc="-rc"
pkgdesc="An astronomical image processing software for Linux. (IRIS clone)"
arch=('aarch64' 'x86_64')
license=('GPL3')
depends=('gtk3' 'lcms2' 'cfitsio' 'wcslib' 'fftw' 'gsl' 'opencv' 'json-glib' 'ffms2' 'gtksourceview4' 'libgit2')
makedepends=('meson' 'cmake' 'ninja' 'libgit2')
optdepends=('gvfs: web access'
            'exiv2: get thumbnails from files'
            'libraw: DSLR RAW files import'
            'libtiff: TIFF import and export'
            'libxisf: XISF format support'
            'libjpeg: JPEG import and export'
            'libjxl: JPEG XL format support'
            'libheif: HEIF format files import'
            'libpng: PNG format support'
            'ffmpeg: avi export support')

options=(!lto)

source=("https://free-astro.org/download/siril-${pkgver}${rc}${pkgrel}.tar.bz2")
sha256sums=('16a3e23d8ae40fd982f7b4bd1955f11bc63117aab4510addabd294fe5416f5a8')

build() {
  cd "$srcdir/$pkgname-$pkgver${rc}${pkgrel}/"
  meson setup --prefix /usr --buildtype release _build
  ninja -C _build
}

package() {
  cd "$srcdir/$pkgname-$pkgver${rc}${pkgrel}/"
  meson install -C _build --destdir "$pkgdir"
}
